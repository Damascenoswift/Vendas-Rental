BEGIN;

-- Seed inicial de tutoriais para o agente (links podem ser substituidos depois)
INSERT INTO public.knowledge_tutorials (
    id,
    title,
    summary,
    module,
    video_url,
    tags,
    allowed_roles,
    allowed_brands,
    is_active,
    sort_order
)
VALUES
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1001',
        'Fluxo completo de indicacao',
        'Passo a passo do cadastro ate o acompanhamento da indicacao.',
        'indicacoes',
        'https://www.youtube.com/watch?v=SEU_VIDEO_FLUXO_INDICACAO',
        ARRAY['indicacoes', 'cadastro', 'fluxo']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        10
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1002',
        'Propostas e contratos na pratica',
        'Como montar proposta, selecionar contrato e preparar para assinatura.',
        'contratos',
        'https://www.youtube.com/watch?v=SEU_VIDEO_CONTRATOS',
        ARRAY['contrato', 'proposta', 'assinatura']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        20
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1003',
        'Assinatura no Clicksign',
        'Envio, acompanhamento e resolucao de pendencias de assinatura.',
        'contratos',
        'https://www.youtube.com/watch?v=SEU_VIDEO_CLICKSIGN',
        ARRAY['clicksign', 'assinatura', 'pendencia']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        30
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1004',
        'Comissao e fechamento financeiro',
        'Como consultar vendas, comissoes e fechamento por competencia.',
        'financeiro',
        'https://www.youtube.com/watch?v=SEU_VIDEO_COMISSAO',
        ARRAY['financeiro', 'comissao', 'fechamento']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        40
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1005',
        'CRM de contatos e oportunidades',
        'Boas praticas para editar contatos e manter dados organizados.',
        'crm',
        'https://www.youtube.com/watch?v=SEU_VIDEO_CRM',
        ARRAY['crm', 'contato', 'oportunidade']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        50
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1006',
        'Obras e tarefas operacionais',
        'Como acompanhar cards de obra, comentarios e prazos.',
        'obras',
        'https://www.youtube.com/watch?v=SEU_VIDEO_OBRAS',
        ARRAY['obra', 'tarefas', 'prazo']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        60
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1007',
        'Estoque e movimentacoes',
        'Entradas, saidas e ajustes de estoque no sistema.',
        'estoque',
        'https://www.youtube.com/watch?v=SEU_VIDEO_ESTOQUE',
        ARRAY['estoque', 'movimentacao', 'produto']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        70
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1008',
        'Inbox de WhatsApp',
        'Uso do inbox para atendimento e continuidade da negociacao.',
        'whatsapp',
        'https://www.youtube.com/watch?v=SEU_VIDEO_WHATSAPP',
        ARRAY['whatsapp', 'atendimento', 'inbox']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        80
    ),
    (
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1009',
        'Como usar o agente de ajuda',
        'Perguntas recomendadas, limites do agente e quando escalar para humano.',
        'ajuda',
        'https://www.youtube.com/watch?v=SEU_VIDEO_AGENTE_AJUDA',
        ARRAY['ajuda', 'ia', 'faq']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        true,
        90
    )
ON CONFLICT (id) DO UPDATE
SET
    title = EXCLUDED.title,
    summary = EXCLUDED.summary,
    module = EXCLUDED.module,
    video_url = EXCLUDED.video_url,
    tags = EXCLUDED.tags,
    allowed_roles = EXCLUDED.allowed_roles,
    allowed_brands = EXCLUDED.allowed_brands,
    is_active = EXCLUDED.is_active,
    sort_order = EXCLUDED.sort_order,
    updated_at = now();

-- Seed inicial de 20 FAQs
INSERT INTO public.knowledge_faq (
    id,
    module,
    question,
    answer,
    keywords,
    related_tutorial_id,
    contract_types,
    allowed_roles,
    allowed_brands,
    priority,
    is_active
)
VALUES
    (
        'a0b1c2d3-1000-4000-9000-000000000001',
        'indicacoes',
        'Como faco para cadastrar uma nova indicacao?',
        'Acesse Indicacoes > Novo, preencha os dados obrigatorios do cliente, valide telefone/e-mail e salve. Depois acompanhe o status na lista de indicacoes.',
        ARRAY['nova indicacao', 'cadastro', 'status']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1001',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        5,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000002',
        'indicacoes',
        'Quais campos sao obrigatorios para uma indicacao?',
        'Nome, telefone e e-mail sao essenciais. Dependendo do fluxo, codigo de instalacao e unidade consumidora podem ser necessarios para avancar no processo.',
        ARRAY['campos obrigatorios', 'indicacao', 'dados minimos']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1001',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000003',
        'indicacoes',
        'Como anexo documentos na indicacao?',
        'Dentro da indicacao, use a area de anexos para subir arquivos permitidos. Aguarde o upload concluir e confirme se o arquivo aparece na lista antes de sair da tela.',
        ARRAY['anexo', 'documento', 'upload']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1001',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000004',
        'contratos',
        'Como gero o contrato a partir da proposta?',
        'Na proposta aprovada, acione a opcao de gerar contrato, selecione o tipo correto (PF ou PJ) e revise os dados antes de enviar para assinatura.',
        ARRAY['gerar contrato', 'proposta', 'assinatura']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1002',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        5,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000005',
        'contratos',
        'Quando usar contrato PF e quando usar PJ?',
        'Use PF quando o titular for pessoa fisica e PJ quando o contratante for empresa com CNPJ. O tipo impacta campos, clausulas e validacoes documentais.',
        ARRAY['pf', 'pj', 'tipo contrato']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1002',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        5,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000006',
        'contratos',
        'Qual o melhor momento para enviar para assinatura?',
        'Envie somente apos revisar dados do cliente, valores, clausulas aplicaveis e anexos necessarios. Isso reduz retrabalho e recusas no processo de assinatura.',
        ARRAY['envio assinatura', 'revisao', 'clicksign']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1003',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000007',
        'contratos',
        'Como acompanho o status da assinatura no Clicksign?',
        'Acesse o contrato e verifique o status de assinatura. Se estiver pendente, confira quem falta assinar e valide se o e-mail/contato do signatario esta correto.',
        ARRAY['status assinatura', 'clicksign', 'pendente']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1003',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000008',
        'contratos',
        'O que fazer quando a assinatura fica travada ou pendente?',
        'Confirme dados do signatario, reenvie o link de assinatura e registre comentario no atendimento. Se persistir, escale para o responsavel de contratos.',
        ARRAY['assinatura travada', 'reenvio', 'suporte contratos']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1003',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000009',
        'financeiro',
        'Onde vejo minhas vendas do dia?',
        'Use o painel de vendas/indicacoes para visualizar o total diario e os registros recentes no seu escopo de marca e permissao.',
        ARRAY['vendas do dia', 'painel', 'indicacoes']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1004',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000010',
        'financeiro',
        'Como consultar comissao por competencia?',
        'No modulo financeiro, filtre a competencia e seu usuario para ver itens elegiveis, pagos e pendentes. Valide status antes de solicitar ajuste.',
        ARRAY['comissao', 'competencia', 'financeiro']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1004',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000011',
        'crm',
        'Como editar um contato no CRM?',
        'Abra o contato, atualize os campos necessarios e salve. Prefira padronizar telefone e e-mail para evitar duplicidade em funis e automacoes.',
        ARRAY['editar contato', 'crm', 'dados']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1005',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000012',
        'crm',
        'O que fazer se encontrar contatos duplicados?',
        'Mantenha o registro mais completo, consolide informacoes relevantes e sinalize o time para evitar novos cadastros com dados divergentes.',
        ARRAY['duplicado', 'contato', 'crm']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1005',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000013',
        'tarefas',
        'Como mover uma tarefa de fase corretamente?',
        'Atualize o status conforme o andamento real, registre observacao curta e garanta que a proxima pessoa responsavel tenha contexto suficiente para continuar.',
        ARRAY['tarefas', 'status', 'fase']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1006',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000014',
        'obras',
        'Como priorizar cards de obra?',
        'Considere prazo de execucao, bloqueios tecnicos e impacto no cliente. Atualize o card e deixe comentario objetivo com a justificativa da prioridade.',
        ARRAY['obra', 'prioridade', 'prazo']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1006',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000015',
        'obras',
        'Como registrar comentario tecnico em obra?',
        'No card da obra, adicione comentario com data/contexto e proxima acao esperada. Evite textos longos sem acao objetiva.',
        ARRAY['comentario tecnico', 'obra', 'historico']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1006',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000016',
        'estoque',
        'Como registrar entrada ou saida de estoque?',
        'Acesse Estoque, selecione o produto e informe tipo de movimentacao, quantidade e referencia. Revise antes de confirmar para manter saldo consistente.',
        ARRAY['estoque', 'entrada', 'saida']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1007',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000017',
        'whatsapp',
        'Como responder clientes no inbox do WhatsApp?',
        'Abra a conversa, confirme o contexto do atendimento e responda com clareza. Sempre registre encaminhamentos para nao perder historico.',
        ARRAY['whatsapp', 'inbox', 'atendimento']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1008',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        3,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000018',
        'ajuda',
        'Quem pode usar o agente de ajuda?',
        'Usuarios com sales_access ativo. O acesso pode variar conforme role e marcas autorizadas no perfil.',
        ARRAY['acesso', 'agente', 'sales_access']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1009',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        5,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000019',
        'contratos',
        'O agente consegue responder sobre clausulas de contrato?',
        'Sim. O agente consulta a base de clausulas cadastradas. Se nao houver clausula relevante ou houver baixa confianca, ele deve sinalizar e recomendar validacao humana.',
        ARRAY['clausula', 'contrato', 'agente']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1009',
        ARRAY['RENTAL_PF', 'RENTAL_PJ', 'DORATA_PF', 'DORATA_PJ']::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        5,
        true
    ),
    (
        'a0b1c2d3-1000-4000-9000-000000000020',
        'ajuda',
        'O que fazer quando o agente nao encontra resposta?',
        'Peca mais contexto (marca, tipo de contrato e tela), consulte o tutorial relacionado e escale para o responsavel da area quando necessario.',
        ARRAY['nao encontrou', 'escalar', 'suporte']::text[],
        '5f4f25d4-1a2c-4e41-8f1a-01b0f00a1009',
        ARRAY[]::public.knowledge_contract_type_enum[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        4,
        true
    )
ON CONFLICT (id) DO UPDATE
SET
    module = EXCLUDED.module,
    question = EXCLUDED.question,
    answer = EXCLUDED.answer,
    keywords = EXCLUDED.keywords,
    related_tutorial_id = EXCLUDED.related_tutorial_id,
    contract_types = EXCLUDED.contract_types,
    allowed_roles = EXCLUDED.allowed_roles,
    allowed_brands = EXCLUDED.allowed_brands,
    priority = EXCLUDED.priority,
    is_active = EXCLUDED.is_active,
    updated_at = now();

-- Estrutura base de clausulas por tipo de contrato (modelo inicial para evolucao com juridico)
INSERT INTO public.knowledge_contract_clauses (
    id,
    contract_type,
    clause_code,
    clause_title,
    clause_text,
    plain_explanation,
    risks,
    keywords,
    allowed_roles,
    allowed_brands,
    version,
    is_active
)
VALUES
    (
        'b1c2d3e4-2000-4000-9000-000000000001',
        'GERAL',
        'CLAUSULA_01_OBJETO',
        'Objeto do contrato',
        'Este modelo define o objeto principal da contratacao, descrevendo escopo, limites e entregaveis esperados entre as partes.',
        'Explica o que esta sendo contratado e evita interpretacoes fora do combinado.',
        'Escopo vago pode gerar discussao comercial e juridica.',
        ARRAY['objeto', 'escopo', 'entregavel']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000002',
        'GERAL',
        'CLAUSULA_02_DEFINICOES',
        'Definicoes e interpretacao',
        'Consolida termos tecnicos e comerciais utilizados no contrato para leitura padrao entre as partes.',
        'Ajuda a equipe a interpretar corretamente termos recorrentes.',
        'Sem definicoes, cada parte pode interpretar termos de forma diferente.',
        ARRAY['definicoes', 'interpretacao', 'termos']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000003',
        'GERAL',
        'CLAUSULA_03_VIGENCIA',
        'Vigencia e renovacao',
        'Estabelece prazo inicial, condicoes de renovacao e marco de inicio da vigencia contratual.',
        'Define por quanto tempo o contrato vale e como pode ser renovado.',
        'Falta de prazo claro pode gerar cobrancas fora do periodo esperado.',
        ARRAY['vigencia', 'prazo', 'renovacao']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000004',
        'GERAL',
        'CLAUSULA_04_PRECO_REAJUSTE',
        'Preco, forma de pagamento e reajuste',
        'Define valores, datas de pagamento, encargos aplicaveis e regras de reajuste previstas.',
        'Centraliza como e quando o cliente paga, incluindo ajustes de valor.',
        'Sem regra de reajuste, o contrato pode perder previsibilidade financeira.',
        ARRAY['preco', 'pagamento', 'reajuste']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000005',
        'GERAL',
        'CLAUSULA_05_OBRIGACOES_CONTRATANTE',
        'Obrigacoes do contratante',
        'Lista responsabilidades do cliente, incluindo fornecimento de dados, documentos e acessos necessarios.',
        'Mostra o que o cliente precisa cumprir para o fluxo funcionar.',
        'Sem obrigacoes claras do cliente, operacao pode atrasar.',
        ARRAY['obrigacoes cliente', 'documentacao', 'acesso']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000006',
        'GERAL',
        'CLAUSULA_06_OBRIGACOES_CONTRATADA',
        'Obrigacoes da contratada',
        'Define deveres da empresa contratada em termos de execucao, comunicacao e suporte.',
        'Esclarece entregas e responsabilidades internas da operacao.',
        'Compromissos mal definidos podem gerar expectativa desalinhada.',
        ARRAY['obrigacoes contratada', 'suporte', 'execucao']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000007',
        'GERAL',
        'CLAUSULA_07_ENTREGA_IMPLANTACAO',
        'Implantacao e aceite',
        'Regra marcos de implantacao, validacao de entrega e criterios de aceite.',
        'Organiza quando o servico e considerado entregue.',
        'Sem criterio de aceite, fechamento pode ficar indefinido.',
        ARRAY['implantacao', 'aceite', 'entrega']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000008',
        'GERAL',
        'CLAUSULA_08_INADIMPLENCIA',
        'Inadimplencia e encargos',
        'Descreve consequencias de atraso de pagamento, encargos e procedimentos de regularizacao.',
        'Explica o que acontece quando ha atraso financeiro.',
        'Sem regra de inadimplencia, cobranca fica fragil.',
        ARRAY['inadimplencia', 'atraso', 'encargos']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000009',
        'GERAL',
        'CLAUSULA_09_MULTA_RESCISAO',
        'Rescisao e multa',
        'Define hipoteses de encerramento antecipado, aviso previo e penalidades cabiveis.',
        'Mostra como encerrar o contrato e quais custos podem existir.',
        'Regras vagas de rescisao geram litigio e perda financeira.',
        ARRAY['rescisao', 'multa', 'aviso previo']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000010',
        'GERAL',
        'CLAUSULA_10_PRIVACIDADE_DADOS',
        'Privacidade e protecao de dados',
        'Define tratamento de dados pessoais, finalidade de uso e responsabilidade de seguranca da informacao.',
        'Direciona conformidade com boas praticas de privacidade.',
        'Risco de nao conformidade e exposicao indevida de dados.',
        ARRAY['lgpd', 'dados', 'privacidade']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000011',
        'GERAL',
        'CLAUSULA_11_CONFIDENCIALIDADE',
        'Confidencialidade',
        'Estabelece dever de sigilo sobre informacoes tecnicas, comerciais e operacionais compartilhadas.',
        'Protege informacoes sensiveis durante e apos a vigencia.',
        'Sem sigilo formal, dados comerciais podem ser expostos.',
        ARRAY['confidencialidade', 'sigilo', 'informacao sensivel']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000012',
        'GERAL',
        'CLAUSULA_12_FORO',
        'Foro e legislacao aplicavel',
        'Define foro competente e regras legais aplicaveis em eventual disputa contratual.',
        'Indica onde eventuais conflitos serao tratados juridicamente.',
        'Foro indefinido aumenta custo e incerteza em disputas.',
        ARRAY['foro', 'legislacao', 'disputa']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental', 'dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000013',
        'RENTAL_PF',
        'CLAUSULA_RPF_01_TITULARIDADE_UC',
        'Titularidade da unidade consumidora (PF)',
        'Clausula especifica para validar vinculo da pessoa fisica com a unidade consumidora informada.',
        'Usada para reduzir divergencias de titularidade no fluxo PF.',
        'Titularidade incorreta bloqueia validacoes operacionais.',
        ARRAY['pf', 'unidade consumidora', 'titularidade']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000014',
        'RENTAL_PF',
        'CLAUSULA_RPF_02_ASSINATURA_CONJUNTA',
        'Assinatura conjunta e representacao (PF)',
        'Estrutura para casos em que ha necessidade de assinaturas complementares no contrato PF.',
        'Define quando mais de um assinante e obrigatorio.',
        'Ausencia de assinante obrigatorio invalida formalizacao.',
        ARRAY['pf', 'assinatura conjunta', 'representacao']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000015',
        'RENTAL_PJ',
        'CLAUSULA_RPJ_01_REPRESENTANTE_LEGAL',
        'Representante legal e poderes (PJ)',
        'Define exigencia de comprovacao de poderes do representante que assina o contrato PJ.',
        'Garante validade da assinatura pela empresa contratante.',
        'Assinatura sem poderes pode anular obrigacoes contratuais.',
        ARRAY['pj', 'representante legal', 'poderes']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000016',
        'RENTAL_PJ',
        'CLAUSULA_RPJ_02_DOCUMENTOS_EMPRESA',
        'Documentacao societaria minima (PJ)',
        'Estabelece documentos societarios obrigatorios para cadastro e validacao contratual da empresa.',
        'Padroniza checklist documental para contratos PJ.',
        'Checklist incompleto atrasa assinatura e ativacao.',
        ARRAY['pj', 'documentacao', 'societario']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['rental']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000017',
        'DORATA_PF',
        'CLAUSULA_DPF_01_REGRAS_COMPENSACAO',
        'Regras de compensacao de energia (Dorata PF)',
        'Modelo de clausula para explicar condicoes de compensacao e limites operacionais no contrato Dorata PF.',
        'Orienta expectativas do cliente sobre creditos e consumo.',
        'Falta de clareza pode gerar reclamacao por expectativa incorreta.',
        ARRAY['dorata', 'pf', 'compensacao']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000018',
        'DORATA_PF',
        'CLAUSULA_DPF_02_LIMITE_CREDITO',
        'Limite de credito energetico (Dorata PF)',
        'Define criterio de acumulacao, uso e validade de creditos no contexto de pessoa fisica.',
        'Ajuda a explicar limite de aproveitamento dos creditos.',
        'Sem regra, cliente pode interpretar saldo de forma equivocada.',
        ARRAY['dorata', 'credito', 'pf']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000019',
        'DORATA_PJ',
        'CLAUSULA_DPJ_01_GESTAO_MULTI_UC',
        'Gestao de multiplas UCs (Dorata PJ)',
        'Estrutura para contratos PJ com mais de uma unidade consumidora vinculada.',
        'Define regras para operacao com carteira de UCs.',
        'Sem regra, distribuicao de credito entre UCs pode gerar conflito.',
        ARRAY['dorata', 'pj', 'multi uc']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['dorata']::public.brand_enum[],
        1,
        true
    ),
    (
        'b1c2d3e4-2000-4000-9000-000000000020',
        'DORATA_PJ',
        'CLAUSULA_DPJ_02_TRIBUTOS',
        'Responsabilidade tributaria (Dorata PJ)',
        'Clausula base para distribuicao de responsabilidade sobre tributos e obrigacoes acessorias no contrato PJ.',
        'Esclarece fronteira de responsabilidade fiscal entre as partes.',
        'Sem alinhamento tributario, risco de contingencia juridica e financeira.',
        ARRAY['dorata', 'pj', 'tributos']::text[],
        ARRAY[]::public.user_role_enum[],
        ARRAY['dorata']::public.brand_enum[],
        1,
        true
    )
ON CONFLICT (id) DO UPDATE
SET
    contract_type = EXCLUDED.contract_type,
    clause_code = EXCLUDED.clause_code,
    clause_title = EXCLUDED.clause_title,
    clause_text = EXCLUDED.clause_text,
    plain_explanation = EXCLUDED.plain_explanation,
    risks = EXCLUDED.risks,
    keywords = EXCLUDED.keywords,
    allowed_roles = EXCLUDED.allowed_roles,
    allowed_brands = EXCLUDED.allowed_brands,
    version = EXCLUDED.version,
    is_active = EXCLUDED.is_active,
    updated_at = now();

NOTIFY pgrst, 'reload schema';

COMMIT;
